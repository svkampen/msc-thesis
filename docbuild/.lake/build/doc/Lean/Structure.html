<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href=".././style.css"></link><link rel="icon" href=".././favicon.svg"></link><link rel="mask-icon" href=".././favicon.svg" color="#000000"></link><link rel="prefetch" href=".././/declarations/declaration-data.bmp" as="image"></link><title>Lean.Structure</title><script defer="true" src=".././mathjax-config.js"></script><script defer="true" src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT=".././";</script><script>const MODULE_NAME="Lean.Structure";</script><script type="module" src=".././jump-src.js"></script><script type="module" src=".././search.js"></script><script type="module" src=".././expand-nav.js"></script><script type="module" src=".././how-about.js"></script><script type="module" src=".././instances.js"></script><script type="module" src=".././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label><span>Documentation</span></h1><h2 class="header_filename break_within"><span class="name">Lean</span>.<span class="name">Structure</span></h2><form action="https://google.com/search" method="get" id="search_form"><input type="hidden" name="sitesearch" value="https://leanprover-community.github.io/mathlib4_docs"></input><input type="text" name="q" autocomplete="off"></input>&#32;<button id="search_button" onclick="javascript: form.action='.././search.html';">Search</button><button>Google site search</button></form></header><nav class="internal_nav"><p><a href="#top">return to top</a></p><p class="gh_nav_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href=".././Lean/Environment.html">Lean.Environment</a></li><li><a href=".././Lean/Exception.html">Lean.Exception</a></li><li><a href=".././Lean/ProjFns.html">Lean.ProjFns</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-Lean.Structure" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#Lean.StructureFieldInfo"><span class="name">Lean</span>.<span class="name">StructureFieldInfo</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.instInhabitedStructureFieldInfo"><span class="name">Lean</span>.<span class="name">instInhabitedStructureFieldInfo</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.instReprStructureFieldInfo"><span class="name">Lean</span>.<span class="name">instReprStructureFieldInfo</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.StructureFieldInfo.lt"><span class="name">Lean</span>.<span class="name">StructureFieldInfo</span>.<span class="name">lt</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.StructureParentInfo"><span class="name">Lean</span>.<span class="name">StructureParentInfo</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.instInhabitedStructureParentInfo"><span class="name">Lean</span>.<span class="name">instInhabitedStructureParentInfo</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.StructureInfo"><span class="name">Lean</span>.<span class="name">StructureInfo</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.instInhabitedStructureInfo"><span class="name">Lean</span>.<span class="name">instInhabitedStructureInfo</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.StructureInfo.lt"><span class="name">Lean</span>.<span class="name">StructureInfo</span>.<span class="name">lt</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.StructureInfo.getProjFn?"><span class="name">Lean</span>.<span class="name">StructureInfo</span>.<span class="name">getProjFn?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.instInhabitedStructureState"><span class="name">Lean</span>.<span class="name">instInhabitedStructureState</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.structureExt"><span class="name">Lean</span>.<span class="name">structureExt</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.StructureDescr"><span class="name">Lean</span>.<span class="name">StructureDescr</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.instInhabitedStructureDescr"><span class="name">Lean</span>.<span class="name">instInhabitedStructureDescr</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.registerStructure"><span class="name">Lean</span>.<span class="name">registerStructure</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.setStructureParents"><span class="name">Lean</span>.<span class="name">setStructureParents</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.getStructureInfo?"><span class="name">Lean</span>.<span class="name">getStructureInfo?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.getStructureInfo"><span class="name">Lean</span>.<span class="name">getStructureInfo</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.getStructureCtor"><span class="name">Lean</span>.<span class="name">getStructureCtor</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.getStructureFields"><span class="name">Lean</span>.<span class="name">getStructureFields</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.getFieldInfo?"><span class="name">Lean</span>.<span class="name">getFieldInfo?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.isSubobjectField?"><span class="name">Lean</span>.<span class="name">isSubobjectField?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.getStructureParentInfo"><span class="name">Lean</span>.<span class="name">getStructureParentInfo</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.getStructureSubobjects"><span class="name">Lean</span>.<span class="name">getStructureSubobjects</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.findField?"><span class="name">Lean</span>.<span class="name">findField?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.getStructureFieldsFlattened"><span class="name">Lean</span>.<span class="name">getStructureFieldsFlattened</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.isStructure"><span class="name">Lean</span>.<span class="name">isStructure</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.getProjFnForField?"><span class="name">Lean</span>.<span class="name">getProjFnForField?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.getProjFnInfoForField?"><span class="name">Lean</span>.<span class="name">getProjFnInfoForField?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.mkDefaultFnOfProjFn"><span class="name">Lean</span>.<span class="name">mkDefaultFnOfProjFn</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.getDefaultFnForField?"><span class="name">Lean</span>.<span class="name">getDefaultFnForField?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.getPathToBaseStructureAux"><span class="name">Lean</span>.<span class="name">getPathToBaseStructureAux</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.getPathToBaseStructure?"><span class="name">Lean</span>.<span class="name">getPathToBaseStructure?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.isStructureLike"><span class="name">Lean</span>.<span class="name">isStructureLike</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.getStructureLikeCtor?"><span class="name">Lean</span>.<span class="name">getStructureLikeCtor?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.getStructureLikeNumFields"><span class="name">Lean</span>.<span class="name">getStructureLikeNumFields</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.StructureResolutionState"><span class="name">Lean</span>.<span class="name">StructureResolutionState</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.instInhabitedStructureResolutionState"><span class="name">Lean</span>.<span class="name">instInhabitedStructureResolutionState</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.structureResolutionExt"><span class="name">Lean</span>.<span class="name">structureResolutionExt</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.StructureResolutionOrderConflict"><span class="name">Lean</span>.<span class="name">StructureResolutionOrderConflict</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.instInhabitedStructureResolutionOrderConflict"><span class="name">Lean</span>.<span class="name">instInhabitedStructureResolutionOrderConflict</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.StructureResolutionOrderResult"><span class="name">Lean</span>.<span class="name">StructureResolutionOrderResult</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.instInhabitedStructureResolutionOrderResult"><span class="name">Lean</span>.<span class="name">instInhabitedStructureResolutionOrderResult</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.computeStructureResolutionOrder"><span class="name">Lean</span>.<span class="name">computeStructureResolutionOrder</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.computeStructureResolutionOrder.selectParent"><span class="name">Lean</span>.<span class="name">computeStructureResolutionOrder</span>.<span class="name">selectParent</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.getStructureResolutionOrder"><span class="name">Lean</span>.<span class="name">getStructureResolutionOrder</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.getAllParentStructures"><span class="name">Lean</span>.<span class="name">getAllParentStructures</span></a></div></nav><main>
<div class="decl" id="Lean.StructureFieldInfo"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L15-L32">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.StructureFieldInfo"><span class="name">Lean</span>.<span class="name">StructureFieldInfo</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><p>Data for a structure field.
These are direct fields of a structure, including &quot;subobject&quot; fields for the embedded parents.
The full collection of fields is the transitive closure of fields through the subobject fields.</p><ul class="structure_fields" id="Lean.StructureFieldInfo.mk"><li id="Lean.StructureFieldInfo.fieldName" class="structure_field"><div class="structure_field_info">fieldName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a></div><div class="structure_field_doc"><p>The name of the field. This is a single-component name.</p></div></li><li id="Lean.StructureFieldInfo.projFn" class="structure_field"><div class="structure_field_info">projFn : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a></div><div class="structure_field_doc"><p>The projection function associated to the field.</p></div></li><li id="Lean.StructureFieldInfo.subobject?" class="structure_field"><div class="structure_field_info">subobject? : <span class="fn"><a href=".././Init/Prelude.html#Option">Option</a> <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a></span></div><div class="structure_field_doc"><p>If this field is for a subobject (i.e., an embedded parent structure), contains the name of the parent structure.</p></div></li><li id="Lean.StructureFieldInfo.binderInfo" class="structure_field"><div class="structure_field_info">binderInfo : <a href=".././Lean/Expr.html#Lean.BinderInfo">Lean.BinderInfo</a></div><div class="structure_field_doc"><p>The binder info for the field from the <code>structure</code> definition.</p></div></li><li id="Lean.StructureFieldInfo.autoParam?" class="structure_field"><div class="structure_field_info">autoParam? : <span class="fn"><a href=".././Init/Prelude.html#Option">Option</a> <a href=".././Lean/Expr.html#Lean.Expr">Lean.Expr</a></span></div><div class="structure_field_doc"><p>If set, the field is an autoparam (a field declared using <code>fld := by ...</code> syntax).
The expression evaluates to a tactic <code>Syntax</code> object. Generally this is an <code>Expr.const</code> expression.</p></div></li></ul><details id="instances-for-list-Lean.StructureFieldInfo" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.instInhabitedStructureFieldInfo"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L32-L32">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.instInhabitedStructureFieldInfo"><span class="name">Lean</span>.<span class="name">instInhabitedStructureFieldInfo</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <a href=".././Lean/Structure.html#Lean.StructureFieldInfo">Lean.StructureFieldInfo</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././Lean/Structure.html#Lean.instInhabitedStructureFieldInfo">Lean.instInhabitedStructureFieldInfo</a> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn">{
    <span class="fn">default</span> :=
      <span class="fn">{ <span class="fn">fieldName</span> := <span class="fn">default</span>, <span class="fn">projFn</span> := <span class="fn">default</span>, <span class="fn">subobject?</span> := <span class="fn">default</span>, <span class="fn">binderInfo</span> := <span class="fn">default</span>, <span class="fn">autoParam?</span> := <span class="fn">default</span> }</span> }</span></span></li></ul></details></div></div><div class="decl" id="Lean.instReprStructureFieldInfo"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L32-L32">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.instReprStructureFieldInfo"><span class="name">Lean</span>.<span class="name">instReprStructureFieldInfo</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Data/Repr.html#Repr">Repr</a> <a href=".././Lean/Structure.html#Lean.StructureFieldInfo">Lean.StructureFieldInfo</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././Lean/Structure.html#Lean.instReprStructureFieldInfo">Lean.instReprStructureFieldInfo</a> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">{ <span class="fn">reprPrec</span> := <a href=".././Lean/Structure.html#_private.Lean.Structure.0.Lean.reprStructureFieldInfo._@.Lean.Structure._hyg.64">Lean.reprStructureFieldInfo✝</a> }</span></span></li></ul></details></div></div><div class="decl" id="Lean.StructureFieldInfo.lt"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L34-L35">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.StructureFieldInfo.lt"><span class="name">Lean</span>.<span class="name">StructureFieldInfo</span>.<span class="name">lt</span></a></span><span class="decl_args">
<span class="fn">(i₁ i₂ : <a href=".././Lean/Structure.html#Lean.StructureFieldInfo">Lean.StructureFieldInfo</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Init/Prelude.html#Bool">Bool</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><span class="fn"><span class="fn">i₁</span>.lt</span> <span class="fn">i₂</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn"><span class="fn"><span class="fn">i₁</span>.fieldName</span>.quickLt</span> <span class="fn"><span class="fn">i₂</span>.fieldName</span></span></span></li></ul></details><details id="instances-for-list-Lean.StructureFieldInfo.lt" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.StructureParentInfo"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L37-L51">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.StructureParentInfo"><span class="name">Lean</span>.<span class="name">StructureParentInfo</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><p>Data for a direct parent of a structure.
Some structure parents are represented as subobjects (embedded structures),
and for these the parent projection is a true projection.
If a structure parent shares a field with a previous parent, it will become an implicit parent,
and all the fields of the structure parent that do not occur in earlier parents are fields of the new structure</p><ul class="structure_fields" id="Lean.StructureParentInfo.mk"><li id="Lean.StructureParentInfo.structName" class="structure_field"><div class="structure_field_info">structName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a></div><div class="structure_field_doc"><p>The name of the parent structure.</p></div></li><li id="Lean.StructureParentInfo.subobject" class="structure_field"><div class="structure_field_info">subobject : <a href=".././Init/Prelude.html#Bool">Bool</a></div><div class="structure_field_doc"><p>Whether this parent structure is represented as a subobject. If so, then there is a <code><a href=".././Lean/Structure.html#Lean.StructureInfo.fieldInfo">fieldInfo</a></code> entry with the same <code><a href=".././Lean/Structure.html#Lean.StructureFieldInfo.projFn">projFn</a></code>.</p></div></li><li id="Lean.StructureParentInfo.projFn" class="structure_field"><div class="structure_field_info">projFn : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a></div><div class="structure_field_doc"><p>The projection function associated to the field. For subobjects, this is the same as the <code><a href=".././Lean/Structure.html#Lean.StructureFieldInfo.projFn">projFn</a></code> in its <code><a href=".././Lean/Structure.html#Lean.StructureInfo.fieldInfo">fieldInfo</a></code> entry.</p></div></li></ul><details id="instances-for-list-Lean.StructureParentInfo" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.instInhabitedStructureParentInfo"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L51-L51">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.instInhabitedStructureParentInfo"><span class="name">Lean</span>.<span class="name">instInhabitedStructureParentInfo</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <a href=".././Lean/Structure.html#Lean.StructureParentInfo">Lean.StructureParentInfo</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././Lean/Structure.html#Lean.instInhabitedStructureParentInfo">Lean.instInhabitedStructureParentInfo</a> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn">{ <span class="fn">default</span> := <span class="fn">{ <span class="fn">structName</span> := <span class="fn">default</span>, <span class="fn">subobject</span> := <span class="fn">default</span>, <span class="fn">projFn</span> := <span class="fn">default</span> }</span> }</span></span></li></ul></details></div></div><div class="decl" id="Lean.StructureInfo"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L53-L66">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.StructureInfo"><span class="name">Lean</span>.<span class="name">StructureInfo</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><p>Data about a type created with the <code>structure</code> command.</p><ul class="structure_fields" id="Lean.StructureInfo.mk"><li id="Lean.StructureInfo.structName" class="structure_field"><div class="structure_field_info">structName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a></div><div class="structure_field_doc"><p>The name of the structure.</p></div></li><li id="Lean.StructureInfo.fieldNames" class="structure_field"><div class="structure_field_info">fieldNames : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a></span></div><div class="structure_field_doc"><p>The direct fields of a structure, sorted by position in the structure.
For example, the <code>s.3</code> notation refers to <code>fieldNames[3 - 1]</code>.</p></div></li><li id="Lean.StructureInfo.fieldInfo" class="structure_field"><div class="structure_field_info">fieldInfo : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Lean/Structure.html#Lean.StructureFieldInfo">Lean.StructureFieldInfo</a></span></div><div class="structure_field_doc"><p>Information about the structure fields, sorted by <code><a href=".././Lean/Structure.html#Lean.StructureFieldInfo.fieldName">fieldName</a></code>.</p></div></li><li id="Lean.StructureInfo.parentInfo" class="structure_field"><div class="structure_field_info">parentInfo : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Lean/Structure.html#Lean.StructureParentInfo">Lean.StructureParentInfo</a></span></div><div class="structure_field_doc"><p>Information about structure parents. These are in the order they appear in the <code>extends</code> clause.</p></div></li></ul><details id="instances-for-list-Lean.StructureInfo" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.instInhabitedStructureInfo"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L66-L66">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.instInhabitedStructureInfo"><span class="name">Lean</span>.<span class="name">instInhabitedStructureInfo</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <a href=".././Lean/Structure.html#Lean.StructureInfo">Lean.StructureInfo</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././Lean/Structure.html#Lean.instInhabitedStructureInfo">Lean.instInhabitedStructureInfo</a> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn">{ <span class="fn">default</span> := <span class="fn">{ <span class="fn">structName</span> := <span class="fn">default</span>, <span class="fn">fieldNames</span> := <span class="fn">default</span>, <span class="fn">fieldInfo</span> := <span class="fn">default</span>, <span class="fn">parentInfo</span> := <span class="fn">default</span> }</span> }</span></span></li></ul></details></div></div><div class="decl" id="Lean.StructureInfo.lt"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L68-L69">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.StructureInfo.lt"><span class="name">Lean</span>.<span class="name">StructureInfo</span>.<span class="name">lt</span></a></span><span class="decl_args">
<span class="fn">(i₁ i₂ : <a href=".././Lean/Structure.html#Lean.StructureInfo">Lean.StructureInfo</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Init/Prelude.html#Bool">Bool</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><span class="fn"><span class="fn">i₁</span>.lt</span> <span class="fn">i₂</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn"><span class="fn"><span class="fn">i₁</span>.structName</span>.quickLt</span> <span class="fn"><span class="fn">i₂</span>.structName</span></span></span></li></ul></details><details id="instances-for-list-Lean.StructureInfo.lt" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.StructureInfo.getProjFn?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L71-L76">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.StructureInfo.getProjFn?"><span class="name">Lean</span>.<span class="name">StructureInfo</span>.<span class="name">getProjFn?</span></a></span><span class="decl_args">
<span class="fn">(info : <a href=".././Lean/Structure.html#Lean.StructureInfo">Lean.StructureInfo</a>)</span></span>
<span class="decl_args">
<span class="fn">(i : <a href=".././Init/Prelude.html#Nat">Nat</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Option">Option</a> <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.StructureInfo.getProjFn?" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.instInhabitedStructureState"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L81-L81">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.instInhabitedStructureState"><span class="name">Lean</span>.<span class="name">instInhabitedStructureState</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <a href=".././Lean/Structure.html#_private.Lean.Structure.0.Lean.StructureState">Lean.StructureState</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././Lean/Structure.html#Lean.instInhabitedStructureState">Lean.instInhabitedStructureState</a> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">{ <span class="fn">default</span> := <span class="fn">{ <span class="fn">map</span> := <span class="fn">default</span> }</span> }</span></span></li></ul></details></div></div><div class="decl" id="Lean.structureExt"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L83-L88">source</a></div><div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.structureExt"><span class="name">Lean</span>.<span class="name">structureExt</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Lean/Environment.html#Lean.PersistentEnvExtension">Lean.PersistentEnvExtension</a> <a href=".././Lean/Structure.html#Lean.StructureInfo">Lean.StructureInfo</a> <a href=".././Lean/Structure.html#Lean.StructureInfo">Lean.StructureInfo</a> <span class="fn">(<a href=".././Init/Prelude.html#Unit">Unit</a> <a href=".././Init/Prelude.html#Prod">×</a> <a href=".././Lean/Structure.html#_private.Lean.Structure.0.Lean.StructureState">Lean.StructureState</a>)</span></span></div></div></div></div><div class="decl" id="Lean.StructureDescr"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L90-L98">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.StructureDescr"><span class="name">Lean</span>.<span class="name">StructureDescr</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><p>A descriptor for a structure, for constructing a <code><a href=".././Lean/Structure.html#Lean.StructureInfo">StructureInfo</a></code> via <code><a href=".././Lean/Structure.html#Lean.registerStructure">Lean.registerStructure</a></code>.</p><ul class="structure_fields" id="Lean.StructureDescr.mk"><li id="Lean.StructureDescr.structName" class="structure_field"><div class="structure_field_info">structName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a></div><div class="structure_field_doc"><p>The name of the structure.</p></div></li><li id="Lean.StructureDescr.fields" class="structure_field"><div class="structure_field_info">fields : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Lean/Structure.html#Lean.StructureFieldInfo">Lean.StructureFieldInfo</a></span></div><div class="structure_field_doc"><p>The fields should be in the order that they appear in the structure's constructor.</p></div></li></ul><details id="instances-for-list-Lean.StructureDescr" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.instInhabitedStructureDescr"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L98-L98">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.instInhabitedStructureDescr"><span class="name">Lean</span>.<span class="name">instInhabitedStructureDescr</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <a href=".././Lean/Structure.html#Lean.StructureDescr">Lean.StructureDescr</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././Lean/Structure.html#Lean.instInhabitedStructureDescr">Lean.instInhabitedStructureDescr</a> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">{ <span class="fn">default</span> := <span class="fn">{ <span class="fn">structName</span> := <span class="fn">default</span>, <span class="fn">fields</span> := <span class="fn">default</span> }</span> }</span></span></li></ul></details></div></div><div class="decl" id="Lean.registerStructure"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L100-L110">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.registerStructure"><span class="name">Lean</span>.<span class="name">registerStructure</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(e : <a href=".././Lean/Structure.html#Lean.StructureDescr">Lean.StructureDescr</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></div></div><p>Declare a new structure to the elaborator.
Every structure created by <code>structure</code> or <code>class</code> has such an entry.
This should be followed up with <code><a href=".././Lean/Structure.html#Lean.setStructureParents">setStructureParents</a></code> and <code>setStructureResolutionOrder</code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.registerStructure" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.setStructureParents"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L112-L119">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.setStructureParents"><span class="name">Lean</span>.<span class="name">setStructureParents</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{m : <span class="fn"><a href=".././foundational_types.html">Type</a> → <a href=".././foundational_types.html">Type</a></span>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Monad">Monad</a> <span class="fn">m</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Lean/Environment.html#Lean.MonadEnv">Lean.MonadEnv</a> <span class="fn">m</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Lean/Exception.html#Lean.MonadError">Lean.MonadError</a> <span class="fn">m</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(structName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args">
<span class="fn">(parentInfo : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Lean/Structure.html#Lean.StructureParentInfo">Lean.StructureParentInfo</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">m</span> <a href=".././Init/Prelude.html#Unit">Unit</a></span></div></div><p>Set parent projection info for a structure defined in the current module.
Throws an error if the structure has not already been registered with <code><a href=".././Lean/Structure.html#Lean.registerStructure">Lean.registerStructure</a></code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.setStructureParents" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.getStructureInfo?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L121-L125">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.getStructureInfo?"><span class="name">Lean</span>.<span class="name">getStructureInfo?</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(structName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Option">Option</a> <a href=".././Lean/Structure.html#Lean.StructureInfo">Lean.StructureInfo</a></span></div></div><p>Gets the <code><a href=".././Lean/Structure.html#Lean.StructureInfo">StructureInfo</a></code> if <code><a href=".././Lean/Structure.html#Lean.StructureParentInfo.structName">structName</a></code> has been declared as a structure to the elaborator.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.getStructureInfo?" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.getStructureInfo"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L127-L135">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.getStructureInfo"><span class="name">Lean</span>.<span class="name">getStructureInfo</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(structName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Lean/Structure.html#Lean.StructureInfo">Lean.StructureInfo</a></div></div><p>Gets the <code><a href=".././Lean/Structure.html#Lean.StructureInfo">StructureInfo</a></code> for <code><a href=".././Lean/Structure.html#Lean.StructureParentInfo.structName">structName</a></code>, which is assumed to have been declared as a structure to the elaborator.
Panics on failure.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.getStructureInfo" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.getStructureCtor"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L137-L151">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.getStructureCtor"><span class="name">Lean</span>.<span class="name">getStructureCtor</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(constName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Lean/Declaration.html#Lean.ConstructorVal">Lean.ConstructorVal</a></div></div><p>Gets the constructor of an inductive type that has exactly one constructor.
This is meant to be used with types that have had been registered as a structure by <code><a href=".././Lean/Structure.html#Lean.registerStructure">registerStructure</a></code>,
but this is not checked.</p><p>Warning: these do <em>not</em> need to be &quot;structure-likes&quot;. A structure-like is non-recursive,
and structure-likes have special kernel support.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.getStructureCtor" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.getStructureFields"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L153-L155">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.getStructureFields"><span class="name">Lean</span>.<span class="name">getStructureFields</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(structName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a></span></div></div><p>Gets the direct field names for the given structure, including subobject fields.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><a href=".././Lean/Structure.html#Lean.getStructureFields">Lean.getStructureFields</a> <span class="fn">env</span> <span class="fn">structName</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn">(<a href=".././Lean/Structure.html#Lean.getStructureInfo">Lean.getStructureInfo</a> <span class="fn">env</span> <span class="fn">structName</span>)</span>.fieldNames</span></span></li></ul></details><details id="instances-for-list-Lean.getStructureFields" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.getFieldInfo?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L157-L162">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.getFieldInfo?"><span class="name">Lean</span>.<span class="name">getFieldInfo?</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(structName fieldName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Option">Option</a> <a href=".././Lean/Structure.html#Lean.StructureFieldInfo">Lean.StructureFieldInfo</a></span></div></div><p>Get the <code><a href=".././Lean/Structure.html#Lean.StructureFieldInfo">StructureFieldInfo</a></code> for the given direct field of the structure.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.getFieldInfo?" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.isSubobjectField?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L164-L169">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.isSubobjectField?"><span class="name">Lean</span>.<span class="name">isSubobjectField?</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(structName fieldName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Option">Option</a> <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a></span></div></div><p>If <code><a href=".././Lean/Structure.html#Lean.StructureFieldInfo.fieldName">fieldName</a></code> is a subobject (that it, if it is an embedded parent structure), then returns the name of that parent structure.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><a href=".././Lean/Structure.html#Lean.isSubobjectField?">Lean.isSubobjectField?</a> <span class="fn">env</span> <span class="fn">structName</span> <span class="fn">fieldName</span></span> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn">match <span class="fn"><a href=".././Lean/Structure.html#Lean.getFieldInfo?">Lean.getFieldInfo?</a> <span class="fn">env</span> <span class="fn">structName</span> <span class="fn">fieldName</span></span> with
  | <span class="fn"><a href=".././Init/Prelude.html#Option.some">some</a> <span class="fn">fieldInfo</span></span> =&gt; <span class="fn"><span class="fn">fieldInfo</span>.subobject?</span>
  | <span class="fn">x</span> =&gt; <span class="fn">none</span></span></span></li></ul></details><details id="instances-for-list-Lean.isSubobjectField?" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.getStructureParentInfo"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L171-L173">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.getStructureParentInfo"><span class="name">Lean</span>.<span class="name">getStructureParentInfo</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(structName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Lean/Structure.html#Lean.StructureParentInfo">Lean.StructureParentInfo</a></span></div></div><p>Get information for all the parents that appear in the <code>extends</code> clause.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><a href=".././Lean/Structure.html#Lean.getStructureParentInfo">Lean.getStructureParentInfo</a> <span class="fn">env</span> <span class="fn">structName</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn">(<a href=".././Lean/Structure.html#Lean.getStructureInfo">Lean.getStructureInfo</a> <span class="fn">env</span> <span class="fn">structName</span>)</span>.parentInfo</span></span></li></ul></details><details id="instances-for-list-Lean.getStructureParentInfo" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.getStructureSubobjects"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L175-L184">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.getStructureSubobjects"><span class="name">Lean</span>.<span class="name">getStructureSubobjects</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(structName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a></span></div></div><p>Return the parent structures that are embedded in the structure.
This is the array of all results from <code><a href=".././Lean/Structure.html#Lean.isSubobjectField?">Lean.isSubobjectField?</a></code> in order.</p><p>Note: this is <em>not</em> a subset of the parents from <code><a href=".././Lean/Structure.html#Lean.getStructureParentInfo">getStructureParentInfo</a></code>.
If a direct parent cannot itself be represented as a subobject,
sometimes one of its parents (or one of their parents, etc.) can.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><a href=".././Lean/Structure.html#Lean.getStructureSubobjects">Lean.getStructureSubobjects</a> <span class="fn">env</span> <span class="fn">structName</span></span> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href=".././Init/Data/Array/Basic.html#Array.filterMap">Array.filterMap</a> <span class="fn">(<a href=".././Lean/Structure.html#Lean.isSubobjectField?">Lean.isSubobjectField?</a> <span class="fn">env</span> <span class="fn">structName</span>)</span> <span class="fn">(<a href=".././Lean/Structure.html#Lean.getStructureFields">Lean.getStructureFields</a> <span class="fn">env</span> <span class="fn">structName</span>)</span></span></span></li></ul></details><details id="instances-for-list-Lean.getStructureSubobjects" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.findField?"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L186-L194">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.findField?"><span class="name">Lean</span>.<span class="name">findField?</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(structName fieldName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Option">Option</a> <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a></span></div></div><p>Return the name of the structure that contains the field relative to structure <code><a href=".././Lean/Structure.html#Lean.StructureParentInfo.structName">structName</a></code>.
If <code><a href=".././Lean/Structure.html#Lean.StructureParentInfo.structName">structName</a></code> contains the field itself, returns that,
and otherwise recursively looks into parents that are subobjects.</p></div></div><div class="decl" id="Lean.getStructureFieldsFlattened"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L204-L218">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.getStructureFieldsFlattened"><span class="name">Lean</span>.<span class="name">getStructureFieldsFlattened</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(structName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args">
<span class="fn">(includeSubobjectFields : <a href=".././Init/Prelude.html#Bool">Bool</a> := <a href=".././Init/Prelude.html#Bool.true">true</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a></span></div></div><p>Returns the full set of field names for the given structure,
&quot;flattening&quot; all the parent structures that are subobject fields.
If <code>includeSubobjectFields</code> is true, then subobject <code>toParent</code> projections are included,
and otherwise they are omitted.</p><p>For example, given <code>Bar</code> such that</p><pre><code class="language-lean">structure Foo where a : <a href=".././Init/Prelude.html#Nat">Nat</a>
structure Bar extends Foo where b : <a href=".././Init/Prelude.html#Nat">Nat</a>
</code></pre><p>this returns <code>#[`toFoo, `a, `b]</code>, or <code>#[`a, `b]</code> when <code>includeSubobjectFields := false</code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><a href=".././Lean/Structure.html#Lean.getStructureFieldsFlattened">Lean.getStructureFieldsFlattened</a> <span class="fn">env</span> <span class="fn">structName</span> <span class="fn">includeSubobjectFields</span></span> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href=".././Lean/Structure.html#_private.Lean.Structure.0.Lean.getStructureFieldsFlattenedAux">Lean.getStructureFieldsFlattenedAux</a> <span class="fn">env</span> <span class="fn">structName</span> <span class="fn">#[]</span> <span class="fn">includeSubobjectFields</span></span></span></li></ul></details><details id="instances-for-list-Lean.getStructureFieldsFlattened" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.isStructure"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L220-L228">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.isStructure"><span class="name">Lean</span>.<span class="name">isStructure</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(constName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Init/Prelude.html#Bool">Bool</a></div></div><p>Returns true if <code>constName</code> is the name of an inductive datatype
created using the <code>structure</code> or <code>class</code> commands.</p><p>These are inductive types for which structure information has been registered with <code><a href=".././Lean/Structure.html#Lean.registerStructure">registerStructure</a></code>.
See also <code><a href=".././Lean/Structure.html#Lean.getStructureInfo?">Lean.getStructureInfo?</a></code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><a href=".././Lean/Structure.html#Lean.isStructure">Lean.isStructure</a> <span class="fn">env</span> <span class="fn">constName</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn">(<a href=".././Lean/Structure.html#Lean.getStructureInfo?">Lean.getStructureInfo?</a> <span class="fn">env</span> <span class="fn">constName</span>)</span>.isSome</span></span></li></ul></details><details id="instances-for-list-Lean.isStructure" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.getProjFnForField?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L230-L234">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.getProjFnForField?"><span class="name">Lean</span>.<span class="name">getProjFnForField?</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(structName fieldName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Option">Option</a> <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><a href=".././Lean/Structure.html#Lean.getProjFnForField?">Lean.getProjFnForField?</a> <span class="fn">env</span> <span class="fn">structName</span> <span class="fn">fieldName</span></span> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn">match <span class="fn"><a href=".././Lean/Structure.html#Lean.getFieldInfo?">Lean.getFieldInfo?</a> <span class="fn">env</span> <span class="fn">structName</span> <span class="fn">fieldName</span></span> with
  | <span class="fn"><a href=".././Init/Prelude.html#Option.some">some</a> <span class="fn">fieldInfo</span></span> =&gt; <span class="fn"><a href=".././Init/Prelude.html#Option.some">some</a> <span class="fn"><span class="fn">fieldInfo</span>.projFn</span></span>
  | <span class="fn">x</span> =&gt; <span class="fn">none</span></span></span></li></ul></details><details id="instances-for-list-Lean.getProjFnForField?" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.getProjFnInfoForField?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L236-L240">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.getProjFnInfoForField?"><span class="name">Lean</span>.<span class="name">getProjFnInfoForField?</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(structName fieldName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Option">Option</a> <span class="fn">(<a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a> <a href=".././Init/Prelude.html#Prod">×</a> <a href=".././Lean/ProjFns.html#Lean.ProjectionFunctionInfo">Lean.ProjectionFunctionInfo</a>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.getProjFnInfoForField?" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.mkDefaultFnOfProjFn"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L242-L244">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.mkDefaultFnOfProjFn"><span class="name">Lean</span>.<span class="name">mkDefaultFnOfProjFn</span></a></span><span class="decl_args">
<span class="fn">(projFn : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a></div></div><p>Get the name of the auxiliary definition that would have the default value for the structure field.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><a href=".././Lean/Structure.html#Lean.mkDefaultFnOfProjFn">Lean.mkDefaultFnOfProjFn</a> <span class="fn">projFn</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn">projFn</span> <a href=".././Init/Prelude.html#HAppend.hAppend">++</a> <span class="fn">`_default</span></span></span></li></ul></details><details id="instances-for-list-Lean.mkDefaultFnOfProjFn" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.getDefaultFnForField?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L246-L253">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.getDefaultFnForField?"><span class="name">Lean</span>.<span class="name">getDefaultFnForField?</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(structName fieldName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Option">Option</a> <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.getDefaultFnForField?" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.getPathToBaseStructureAux"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L255-L271">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.getPathToBaseStructureAux"><span class="name">Lean</span>.<span class="name">getPathToBaseStructureAux</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(baseStructName structName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args">
<span class="fn">(path : <span class="fn"><a href=".././Init/Prelude.html#List">List</a> <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Option">Option</a> <span class="fn">(<a href=".././Init/Prelude.html#List">List</a> <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span></div></div></div></div><div class="decl" id="Lean.getPathToBaseStructure?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L273-L278">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.getPathToBaseStructure?"><span class="name">Lean</span>.<span class="name">getPathToBaseStructure?</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(baseStructName structName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Option">Option</a> <span class="fn">(<a href=".././Init/Prelude.html#List">List</a> <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span></div></div><p>If <code>baseStructName</code> is an ancestor structure for <code><a href=".././Lean/Structure.html#Lean.StructureParentInfo.structName">structName</a></code>, then return a sequence of projection functions
to go from <code><a href=".././Lean/Structure.html#Lean.StructureParentInfo.structName">structName</a></code> to <code>baseStructName</code>. Returns <code>[]</code> if <code>baseStructName == <a href=".././Lean/Structure.html#Lean.StructureParentInfo.structName">structName</a></code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><a href=".././Lean/Structure.html#Lean.getPathToBaseStructure?">Lean.getPathToBaseStructure?</a> <span class="fn">env</span> <span class="fn">baseStructName</span> <span class="fn">structName</span></span> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href=".././Lean/Structure.html#Lean.getPathToBaseStructureAux">Lean.getPathToBaseStructureAux</a> <span class="fn">env</span> <span class="fn">baseStructName</span> <span class="fn">structName</span> <span class="fn">[]</span></span></span></li></ul></details><details id="instances-for-list-Lean.getPathToBaseStructure?" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.isStructureLike"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L280-L288">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.isStructureLike"><span class="name">Lean</span>.<span class="name">isStructureLike</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(constName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Init/Prelude.html#Bool">Bool</a></div></div><p>Returns true iff <code>constName</code> is a non-recursive inductive datatype that has only one constructor and no indices.</p><p>Such types have special kernel support. This must be in sync with <code>is_structure_like</code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.isStructureLike" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.getStructureLikeCtor?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L290-L299">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.getStructureLikeCtor?"><span class="name">Lean</span>.<span class="name">getStructureLikeCtor?</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(constName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Option">Option</a> <a href=".././Lean/Declaration.html#Lean.ConstructorVal">Lean.ConstructorVal</a></span></div></div><p>Returns the constructor of the structure named <code>constName</code> if it is a non-recursive single-constructor inductive type with no indices.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.getStructureLikeCtor?" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.getStructureLikeNumFields"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L301-L308">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.getStructureLikeNumFields"><span class="name">Lean</span>.<span class="name">getStructureLikeNumFields</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(constName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Init/Prelude.html#Nat">Nat</a></div></div><p>Return number of fields for a structure-like type</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.getStructureLikeNumFields" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="mod_doc"><h3 class="markdown-heading" id="Resolution-orders">Resolution orders <a class="hover-link" href="#Resolution-orders">#</a></h3><p>This section is for computations to determine which namespaces to visit when resolving field notation.
While the set of namespaces is clear (after a structure's namespace, it is the namespaces for <em>all</em> parents),
the question is the order to visit them in.</p><p>We use the C3 superclass linearization algorithm from Barrett et al., &quot;A Monotonic Superclass Linearization for Dylan&quot;, OOPSLA 1996.
For reference, the C3 linearization is known as the &quot;method resolution order&quot; (MRO) <a href="https://docs.python.org/3/howto/mro.html">in Python</a>.</p><p>The basic idea is that we want to find a resolution order with the following property:
For each structure <code>S</code> that appears in the resolution order, if its direct parents are <code>P₁ .. Pₙ</code>,
then <code>S P₁ ... Pₙ</code> forms a subsequence of the resolution order.</p><p>This has a stability property where if <code>S</code> extends <code>S'</code>, then the resolution order of <code>S</code> contains the resolution order of <code>S'</code> as a subsequence.
It also has the key property that if <code>P</code> and <code>P'</code> are parents of <code>S</code>, then we visit <code>P</code> and <code>P'</code> before we visit the shared parents of <code>P</code> and <code>P'</code>.</p><p>Finding such a resolution order might not be possible.
Still, we can enable a relaxation of the algorithm by ignoring one or more parent resolution orders, starting from the end.</p><p>In Hivert and Thiéry &quot;Controlling the C3 super class linearization algorithm for large hierarchies of classes&quot;
<a href="https://arxiv.org/pdf/2401.12740">https://arxiv.org/pdf/2401.12740</a> the authors discuss how in SageMath, which has thousands of classes,
C3 can be difficult to control, since maintaining correct direct parent orders is a burden.
They give suggestions that have worked for the SageMath project.
We may consider introducing an environment extension with ordering hints to help guide the algorithm if we see similar difficulties.</p></div><div class="decl" id="Lean.StructureResolutionState"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L337-L339">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.StructureResolutionState"><span class="name">Lean</span>.<span class="name">StructureResolutionState</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.StructureResolutionState.mk"><li id="Lean.StructureResolutionState.resolutions" class="structure_field"><div class="structure_field_info">resolutions : <span class="fn"><a href=".././Lean/Data/PersistentHashMap.html#Lean.PHashMap">Lean.PHashMap</a> <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a> <span class="fn">(<a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span></div></li></ul><details id="instances-for-list-Lean.StructureResolutionState" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.instInhabitedStructureResolutionState"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L339-L339">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.instInhabitedStructureResolutionState"><span class="name">Lean</span>.<span class="name">instInhabitedStructureResolutionState</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <a href=".././Lean/Structure.html#Lean.StructureResolutionState">Lean.StructureResolutionState</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././Lean/Structure.html#Lean.instInhabitedStructureResolutionState">Lean.instInhabitedStructureResolutionState</a> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">{ <span class="fn">default</span> := <span class="fn">{ <span class="fn">resolutions</span> := <span class="fn">default</span> }</span> }</span></span></li></ul></details></div></div><div class="decl" id="Lean.structureResolutionExt"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L341-L346">source</a></div><div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.structureResolutionExt"><span class="name">Lean</span>.<span class="name">structureResolutionExt</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Lean/Environment.html#Lean.EnvExtension">Lean.EnvExtension</a> <a href=".././Lean/Structure.html#Lean.StructureResolutionState">Lean.StructureResolutionState</a></span></div></div><p>We use an environment extension to cache resolution orders.
These are not expensive to compute, but worth caching, and we save olean storage space.</p></div></div><div class="decl" id="Lean.StructureResolutionOrderConflict"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L357-L363">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.StructureResolutionOrderConflict"><span class="name">Lean</span>.<span class="name">StructureResolutionOrderConflict</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><p>&quot;The <code><a href=".././Lean/Structure.html#Lean.StructureResolutionOrderConflict.badParent">badParent</a></code> must come after the <code><a href=".././Lean/Structure.html#Lean.StructureResolutionOrderConflict.conflicts">conflicts</a></code>.</p><ul class="structure_fields" id="Lean.StructureResolutionOrderConflict.mk"><li id="Lean.StructureResolutionOrderConflict.isDirectParent" class="structure_field"><div class="structure_field_info">isDirectParent : <a href=".././Init/Prelude.html#Bool">Bool</a></div></li><li id="Lean.StructureResolutionOrderConflict.badParent" class="structure_field"><div class="structure_field_info">badParent : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a></div></li><li id="Lean.StructureResolutionOrderConflict.conflicts" class="structure_field"><div class="structure_field_info">conflicts : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href=".././Init/Prelude.html#Bool">Bool</a> <a href=".././Init/Prelude.html#Prod">×</a> <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span></div><div class="structure_field_doc"><p>Conflicts that must come before <code><a href=".././Lean/Structure.html#Lean.StructureResolutionOrderConflict.badParent">badParent</a></code>. The flag is whether it is a direct parent.</p></div></li></ul><details id="instances-for-list-Lean.StructureResolutionOrderConflict" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.instInhabitedStructureResolutionOrderConflict"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L363-L363">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.instInhabitedStructureResolutionOrderConflict"><span class="name">Lean</span>.<span class="name">instInhabitedStructureResolutionOrderConflict</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <a href=".././Lean/Structure.html#Lean.StructureResolutionOrderConflict">Lean.StructureResolutionOrderConflict</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././Lean/Structure.html#Lean.instInhabitedStructureResolutionOrderConflict">Lean.instInhabitedStructureResolutionOrderConflict</a> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn">{ <span class="fn">default</span> := <span class="fn">{ <span class="fn">isDirectParent</span> := <span class="fn">default</span>, <span class="fn">badParent</span> := <span class="fn">default</span>, <span class="fn">conflicts</span> := <span class="fn">default</span> }</span> }</span></span></li></ul></details></div></div><div class="decl" id="Lean.StructureResolutionOrderResult"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L365-L368">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.StructureResolutionOrderResult"><span class="name">Lean</span>.<span class="name">StructureResolutionOrderResult</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.StructureResolutionOrderResult.mk"><li id="Lean.StructureResolutionOrderResult.resolutionOrder" class="structure_field"><div class="structure_field_info">resolutionOrder : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a></span></div></li><li id="Lean.StructureResolutionOrderResult.conflicts" class="structure_field"><div class="structure_field_info">conflicts : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Lean/Structure.html#Lean.StructureResolutionOrderConflict">Lean.StructureResolutionOrderConflict</a></span></div></li></ul><details id="instances-for-list-Lean.StructureResolutionOrderResult" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.instInhabitedStructureResolutionOrderResult"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L368-L368">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.instInhabitedStructureResolutionOrderResult"><span class="name">Lean</span>.<span class="name">instInhabitedStructureResolutionOrderResult</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <a href=".././Lean/Structure.html#Lean.StructureResolutionOrderResult">Lean.StructureResolutionOrderResult</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././Lean/Structure.html#Lean.instInhabitedStructureResolutionOrderResult">Lean.instInhabitedStructureResolutionOrderResult</a> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">{ <span class="fn">default</span> := <span class="fn">{ <span class="fn">resolutionOrder</span> := <span class="fn">default</span>, <span class="fn">conflicts</span> := <span class="fn">default</span> }</span> }</span></span></li></ul></details></div></div><div class="decl" id="Lean.computeStructureResolutionOrder"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L370-L422">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.computeStructureResolutionOrder"><span class="name">Lean</span>.<span class="name">computeStructureResolutionOrder</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{m : <span class="fn"><a href=".././foundational_types.html">Type</a> → <a href=".././foundational_types.html">Type</a></span>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Monad">Monad</a> <span class="fn">m</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Lean/Environment.html#Lean.MonadEnv">Lean.MonadEnv</a> <span class="fn">m</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(structName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args">
<span class="fn">(relaxed : <a href=".././Init/Prelude.html#Bool">Bool</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">m</span> <a href=".././Lean/Structure.html#Lean.StructureResolutionOrderResult">Lean.StructureResolutionOrderResult</a></span></div></div><p>Computes and caches the C3 linearization. Assumes parents have already been set with <code><a href=".././Lean/Structure.html#Lean.setStructureParents">setStructureParents</a></code>.
If <code>relaxed</code> is false, then if the linearization cannot be computed, conflicts are recorded in the return value.</p></div></div><div class="decl" id="Lean.computeStructureResolutionOrder.selectParent"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L411-L422">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.computeStructureResolutionOrder.selectParent"><span class="name">Lean</span>.<span class="name">computeStructureResolutionOrder</span>.<span class="name">selectParent</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{m : <span class="fn"><a href=".././foundational_types.html">Type</a> → <a href=".././foundational_types.html">Type</a></span>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Monad">Monad</a> <span class="fn">m</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(resOrders : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">m</span> <span class="fn">(<a href=".././Init/Prelude.html#Bool">Bool</a> <a href=".././Init/Prelude.html#Prod">×</a> <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.computeStructureResolutionOrder.selectParent" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.getStructureResolutionOrder"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L424-L429">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.getStructureResolutionOrder"><span class="name">Lean</span>.<span class="name">getStructureResolutionOrder</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{m : <span class="fn"><a href=".././foundational_types.html">Type</a> → <a href=".././foundational_types.html">Type</a></span>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Monad">Monad</a> <span class="fn">m</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Lean/Environment.html#Lean.MonadEnv">Lean.MonadEnv</a> <span class="fn">m</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(structName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">m</span> <span class="fn">(<a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span></div></div><p>Gets the resolution order for a structure.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><a href=".././Lean/Structure.html#Lean.getStructureResolutionOrder">Lean.getStructureResolutionOrder</a> <span class="fn">structName</span></span> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn"><span class="fn">(fun (<span class="fn">x</span> : <a href=".././Lean/Structure.html#Lean.StructureResolutionOrderResult">Lean.StructureResolutionOrderResult</a>) =&gt; <span class="fn"><span class="fn">x</span>.resolutionOrder</span>)</span> <a href=".././Init/Prelude.html#Functor.map">&lt;$&gt;</a>     <span class="fn"><a href=".././Lean/Structure.html#Lean.computeStructureResolutionOrder">Lean.computeStructureResolutionOrder</a> <span class="fn">structName</span> <a href=".././Init/Prelude.html#Bool.true">true</a></span></span></span></li></ul></details><details id="instances-for-list-Lean.getStructureResolutionOrder" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.getAllParentStructures"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/410fab7284703f41660ca2454218dcca9b2ec896/src/Lean/Structure.lean#L431-L436">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Structure.html#Lean.getAllParentStructures"><span class="name">Lean</span>.<span class="name">getAllParentStructures</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{m : <span class="fn"><a href=".././foundational_types.html">Type</a> → <a href=".././foundational_types.html">Type</a></span>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Monad">Monad</a> <span class="fn">m</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Lean/Environment.html#Lean.MonadEnv">Lean.MonadEnv</a> <span class="fn">m</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(structName : <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">m</span> <span class="fn">(<a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span></div></div><p>Returns the transitive closure of all parent structures of the structure.
This is the same as <code><a href=".././Lean/Structure.html#Lean.getStructureResolutionOrder">Lean.getStructureResolutionOrder</a></code> but without including <code><a href=".././Lean/Structure.html#Lean.StructureParentInfo.structName">structName</a></code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><a href=".././Lean/Structure.html#Lean.getAllParentStructures">Lean.getAllParentStructures</a> <span class="fn">structName</span></span> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn"><span class="fn">(fun (<span class="fn">x</span> : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Init/Prelude.html#Lean.Name">Lean.Name</a></span>) =&gt; <span class="fn"><span class="fn"><span class="fn">x</span>.erase</span> <span class="fn">structName</span></span>)</span> <a href=".././Init/Prelude.html#Functor.map">&lt;$&gt;</a> <span class="fn"><a href=".././Lean/Structure.html#Lean.getStructureResolutionOrder">Lean.getStructureResolutionOrder</a> <span class="fn">structName</span></span></span></span></li></ul></details><details id="instances-for-list-Lean.getAllParentStructures" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div></main>
<nav class="nav"><iframe src=".././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>